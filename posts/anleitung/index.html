<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Münzzählautomat DIY | SWH Jannis</title><link rel=stylesheet href=https://cptjannis.github.io/SWH_Jannis/assets/css/post.css><script defer src=https://cptjannis.github.io/SWH_Jannis/assets/js/lbox.js></script>
<link rel=stylesheet href=https://cptjannis.github.io/SWH_Jannis/assets/css/common.css></head><body><main><header><a class=site-title href=https://cptjannis.github.io/SWH_Jannis/>SWH Jannis</a></header><section class=article><div class=article-header><h2 class=article-title>Münzzählautomat DIY</h2><small class=date>Tue Jul 11, 2023</small><div class=tags><a href=https://cptjannis.github.io/SWH_Jannis/tags/Abschlussprojekt class=tag>Abschlussprojekt</a>
<a href=https://cptjannis.github.io/SWH_Jannis/tags/Streiflicht class=tag>Streiflicht</a></div></div><div class=content><p>Solltet ihr ein Sparschwein zuhause haben und möchtet einen kurzen Zwischenstand über dessen Inhalt, könnt ihr entweder zählen oder baut einen solchen Münzzählautomaten nach, und zählt nie wieder.</p><h2 id=materialliste>Materialliste</h2><p>Teile:</p><ul><li>5x Holzplatten 50x30</li><li>2x Pressspan 50x30</li><li>2x Lötplatinen</li><li>2x 10cm Kupferdraht</li><li>1x Holzleim</li><li>1x Heißkleber</li><li>1x Kugellager</li><li>1x 2 Komponenten Kleber</li></ul><p>Hardware :</p><ul><li>8x IR TCRT5000 Abstandssensoren</li><li>1x Schrittmotor 28BYJ-48 mit ULN2003 Treiberplatine</li><li>1x OLED Display SSD1306</li><li>1x Arduino Mega 2560</li></ul><h2 id=schritt-1-vorbereitung>Schritt 1 Vorbereitung:</h2><p>Diese 3D Modelle müsst ihr slicen und drucken.<br><a href=https://github.com/CptJannis/Data_SWH/blob/main/3D%20Druck/Rampe_Getrennt%20v5.stl>Rampe_Getrennnt v5.stl</a><br><a href=https://github.com/CptJannis/Data_SWH/blob/main/3D%20Druck/Zahnrad%20v3.stl>Zahnrad v3.stl</a><br><a href=https://github.com/CptJannis/Data_SWH/blob/main/3D%20Druck/Kugellager_passend.stl>Kugellager_passend.stl</a></p><p>Diese Schablonen müsst ihr Lasercutten oder optional per Hand sägen<br><a href=https://github.com/CptJannis/Data_SWH/blob/main/Lasercut/Mototrplatte.png>Mototrplatte.png</a><br><a href=https://github.com/CptJannis/Data_SWH/blob/main/Lasercut/Schieber%20Platte%20scaled.png>Schieber Platte scaled.png</a><br><a href=https://github.com/CptJannis/Data_SWH/blob/main/Lasercut/Drehscheibe.png>Drehscheibe.png</a></p><p>hier liegen alle Dateine zum Download bereit: <a href=https://github.com/CptJannis/Data_SWH>https://github.com/CptJannis/Data_SWH</a></p><h2 id=schritt-2-mechanik-coinpusher>Schritt 2 Mechanik Coinpusher:</h2><ol><li>Den Schraubenhalter in das Kugellager einsetzten.</li><li>Mit einer Gewindeschraube 5mm Durchmesser, das große Zahnrad an dem Kugellager befestigen</li><li>Auf der Hauptplatte, jeweils in jedem Eck vier, 2mm Löcher bohren.</li><li>Auf dem Rand der runden Drehscheibe, ein 5mm Loch für die zweite Gewindeschraube bohren.</li><li>Die kürzere Gewindeschraube an der Drehscheibe festschrauben.</li><li>Die Runde Drehscheibe auf der langen Schraube aufdrehen. (Muttern und Unterlegscheiben nicht vergessen)</li><li>Den Motor mit einem Heißkleber am vorgefertigtem Loch befestigen.</li><li>Kleines Zahnrad für den Motor aufstecken.</li><li>Die vier langen Schrauben an jedem Ecke festschrauben. Die Gewindeeinstätze auch. (Die kleinen Schrauben können erst beim Einbau aufgeschraubt werden.</li><li>Bewegliche Platte an den Rändern zusägen, damit sie nicht mehr an den Standschrauben hängen bleibt.</li></ol><p><img src=1.jpeg alt="Bild 1">
Bild 1</p><p><img src=2.jpeg alt="Bild 2">
Bild 2</p><h1 id=schritt-3-münzerkennung>Schritt 3 Münzerkennung:</h1><ol><li>In die quadratische Lasergecuttete Platte 17 Rillen einschneiden. Auf der gegenüberliegenden Seite das gleiche Spiel. Die Rillen haben eine tiefe von 1mm.</li><li>Die beiden nicht isolierten Kupferdrähte um die Platte wickeln. Die Drähte dürfen sich auf keinen Fall berühren.</li><li>Drähte kürzen mit einem Kabel verlöten und abisolieren.</li></ol><h1 id=schritt-4-gehäuse>Schritt 4 Gehäuse:</h1><p>Für die Vorderwand und Hinterwand nehmen wir die Platten wie sie sind. Die beiden Seiten Wände haben die Maße 20x30. Der Boden und die Decke muss auf die Maße 50x20 zugesägt werden.</p><p>Nun brauchen wir noch Platten für das Innenleben. Die Platte auf der die Mechanik steht, hat die Maße: 15,5x27.</p><p><img src=3.jpeg alt="Bild 3"></p><p>Bild 3</p><p>Da es sein kann, dass die Holzplatten leicht gebogen sind, kann es vorkommen dass die anzuleimende Platte Spalte zu den Wänden aufweist und somit irgendwo aufliegen muss um fest verleimt werden zu können. Deshalb habe ich die kleinen Blöcke zurecht geschnitten und angeleimt.</p><p>Danach kann die Trennwand wie in Bild 4 angeleimt werden. Maße Trennwand: 22x30.</p><p><img src=4.jpeg alt="Bild 4">
Bild 4</p><p>Die Rampe mit den Maßen 16x2,8, kann mit einem Winkel angeschraubt werden. Zuvor muss man mit etwas Gefühl sie von einem 90° Winkel ein 100° Winkel daraus machen. Die hinausstehenden Schrauben müssen danach aber mit einer Flex abgetrennt werden. Damit der Schieber nicht verrutscht muss links und rechts davon ein kleiner Holzklotz angeschraubt werden.</p><p><img src=5.jpeg alt="Bild 5">
Bild 5</p><p>Die beiden Teile für die Schiene müssen mit 2 Komponentenkleber zusammengeklebt werden. Das ganze sollte über Nacht trocknen. Kleberreste welche die Laufruhe der Münzen negativ beeinträchtigen können müssen entfernt werden.</p><p><img src=6.jpeg alt="Bild 6">
Bild 6</p><p>Die Rampe muss mit einem kleinen Abstand an der Außenwand befestigt werden, damit die Münze zuverlässig hinunterrollt und nicht stecken bleibt.</p><p>Hinzu kommen zwei Dreiecke welche rechts von der Schiene festgeklebt werden müssen. Von den Dreiecken werden insgesamt 4 benötigt. Die Maße sind hierbei 16cm Länge, die Lange Außenseite ist 3,7cm lang und die kurze 1cm.</p><p>Die anderen zwei Dreiecke werden für den richtigen Winkel der Münzen benötigt. Die Dreiecke müssen den gleichen Winkel wie die Schiene haben (Bild 3).</p><h1 id=schritt-4-abstandssensoren>Schritt 4 Abstandssensoren:</h1><ol><li>Aus dem Pressspan eine 10x31 Platte zurecht sägen.</li><li>8 Löcher Bohren welche direkt gegenüber der Löcher der Schiene liegen, über die die Münzen nach Größe sortiert werden.</li><li>Sensoren durch die Löcher stecken und festkleben.</li><li>(Beim Testen der Sensoren kann die kleine Schraube auf der Vorderseite benutzt werden. Sie ist für den Abstand zuständig, ab den die minimale Abstandserkennung ohne hinzuschalten der 5V des Digital Pins möglich ist.)</li></ol><p><img src=7.jpeg alt="Bild 7"></p><h1 id=schritt-5-code>Schritt 5 Code:</h1><p>Zu Beginn müssen alle Bibliotheken, Pins und sonstige Variablen angegeben werden.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-jsx data-lang=jsx><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>Adafruit_GFX.h</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>Adafruit_GrayOLED.h</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>Adafruit_SPITFT.h</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>Adafruit_SPITFT_Macros.h</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>gfxfont.h</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>Stepper.h</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>Wire.h</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> <span style=color:#e6db74>&#34;SSD1306Ascii.h&#34;</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> <span style=color:#e6db74>&#34;SSD1306AsciiWire.h&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>SPI.h</span>&gt;
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>include</span> &lt;<span style=color:#f92672>SD.h</span>&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>define</span> <span style=color:#a6e22e>I2C_ADDRESS</span> <span style=color:#ae81ff>0x3C</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>SSD1306AsciiWire</span> <span style=color:#a6e22e>oled</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SPU</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2048</span>; <span style=color:#75715e>// Schritte pro Umdrehung.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Stepper</span> <span style=color:#a6e22e>Motor</span>(<span style=color:#a6e22e>SPU</span>, <span style=color:#ae81ff>8</span>,<span style=color:#ae81ff>10</span>,<span style=color:#ae81ff>9</span>,<span style=color:#ae81ff>11</span>); <span style=color:#75715e>// Der Schrittmotor erhält die Bezeichnung &#34;Motor&#34; und es wird angegeben an welchen Pins der Motor angeschlossen ist.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Pin für Muenzerkennung
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>Metall</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Pin für SD Kartenlesegerät
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> <span style=color:#a6e22e>chipSelect</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>53</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Variablen für die Nutzung der SD utility library Funktionen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>Sd2Card</span> <span style=color:#a6e22e>card</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>SdVolume</span> <span style=color:#a6e22e>volume</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>SdFile</span> <span style=color:#a6e22e>root</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Abstandssensoren
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin1</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>27</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin2</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>26</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin3</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>31</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin4</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin5</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>29</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin6</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin7</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>28</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>SensorPin8</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>24</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Gesamtvermögen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>double</span> <span style=color:#a6e22e>MoneyInBank</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Um die Aktinonen des Motors und der Münzerkennung richtig zu timen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>Period</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1400</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>myTime</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>int</span> <span style=color:#a6e22e>actualTime</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Um sich zu merken welcher Abstandssensor ausgeschlöst hat
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin1</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin2</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin3</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin4</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin5</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin6</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin7</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>bool</span> <span style=color:#a6e22e>Pin8</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// File welche auf der SD Karte liegt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>File</span> <span style=color:#a6e22e>bankFile</span>;
</span></span></code></pre></div><p>Danach wird in dem Setup versucht eine SD Karte zu erkennen auf der dann der Gesamtbetrag gespeichert werden soll. Da bei meinem SD Karten Modul keine der SD Karten richtig beschreiben, oder von ihnen lesen konnte habe ich die Aktualisierung ausgelassen.
Heißt die SD Karte wird erkannt und wäre bereit beschrieben zu werden, wird sie aber in meinem Code nicht. Wenn ihr also nicht bei jedem Start der Maschine von 0 zählen wollt sondern einen gespeicherten Stand abrufen möchtet, müsst ihr den Code erweitern.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  pinMode(Metall, INPUT_PULLUP);
</span></span><span style=display:flex><span>  pinMode(SensorPin1, INPUT);
</span></span><span style=display:flex><span>  pinMode(SensorPin2, INPUT);
</span></span><span style=display:flex><span>  pinMode(SensorPin3, INPUT);
</span></span><span style=display:flex><span>  pinMode(SensorPin4, INPUT);
</span></span><span style=display:flex><span>  pinMode(SensorPin5, INPUT);
</span></span><span style=display:flex><span>  pinMode(SensorPin6, INPUT);
</span></span><span style=display:flex><span>  pinMode(SensorPin7, INPUT);
</span></span><span style=display:flex><span>  pinMode(SensorPin8, INPUT);
</span></span><span style=display:flex><span>  Motor.setSpeed(<span style=color:#ae81ff>16</span>); <span style=color:#75715e>//Motor-Geschwindigkeit
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  Serial.begin(<span style=color:#ae81ff>9600</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Initialisieren der SD Karte
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>   <span style=color:#66d9ef>while</span> (<span style=color:#f92672>!</span>Serial) {
</span></span><span style=display:flex><span>    ; <span style=color:#75715e>// wait for serial port to connect. Needed for native USB port only
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  Serial.print(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Initializing SD card...&#34;</span>);
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>card.init(SPI_HALF_SPEED, chipSelect)) {
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;initialization failed. Things to check:&#34;</span>);
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;* is a card inserted?&#34;</span>);
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;* is your wiring correct?&#34;</span>);
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;* did you change the chipSelect pin to match your shield or module?&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;Wiring is correct and a card is present.&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (SD.exists(<span style=color:#e6db74>&#34;bankFile.txt&#34;</span>)) {
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;bankFile.txt exists.&#34;</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;bankFile.txt doesn&#39;t exist.&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  bankFile <span style=color:#f92672>=</span> SD.open(<span style=color:#e6db74>&#34;bankFile.txt&#34;</span>, FILE_WRITE);
</span></span><span style=display:flex><span>  <span style=color:#75715e>// if the file opened okay, write to it:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (bankFile) {
</span></span><span style=display:flex><span>    Serial.print(<span style=color:#e6db74>&#34;Writing to test.txt...&#34;</span>);
</span></span><span style=display:flex><span>    bankFile.println(MoneyInBank);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// close the file:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    bankFile.close();
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;done.&#34;</span>);
</span></span><span style=display:flex><span>  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// if the file didn&#39;t open, print an error:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    Serial.println(<span style=color:#e6db74>&#34;error opening bankFile.txt&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// OLED Display 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  Wire.begin();
</span></span><span style=display:flex><span>  Wire.setClock(<span style=color:#ae81ff>400000L</span>);
</span></span><span style=display:flex><span>  oled.begin(<span style=color:#f92672>&amp;</span>Adafruit128x64, I2C_ADDRESS);
</span></span><span style=display:flex><span>  oled.setFont(System5x7); <span style=color:#75715e>// Auswahl der Schriftart
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  oled.clear(); <span style=color:#75715e>//Löschen der aktuellen Displayanzeige
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>);
</span></span><span style=display:flex><span>  oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>  oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>  oled.print(MoneyInBank);
</span></span><span style=display:flex><span>  oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Nun muss geschaut werden, ob eine Münze erkannt wird. Danach schiebt der Motor den Schieber, wodurch die Münze herunterfällt und auf die Schiene rollt. Sobald die Münze rollt darf der Motor nicht mehr drehen, da wir sonst nicht in die Loop kommen, in der die Sensoren Updates liefern. Deshalb gibt es den Timer in der While-loop.</p><p>Schaut wie lange die zwei Euro Münze an Zeit braucht um durch ihr Loch zu fallen und stellt wenn nötig die Period Time neu ein.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>loop</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Bool um zu erkennen, ob Münze aufgelegt wurde
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>bool</span> MetallErkannt <span style=color:#f92672>=</span> digitalRead(Metall);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>MetallErkannt){ 
</span></span><span style=display:flex><span>    Motor.step(<span style=color:#f92672>-</span><span style=color:#ae81ff>1500</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>//Serial.println(&#34;Muenze erkannt!&#34;);
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    myTime <span style=color:#f92672>=</span> millis();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span>((actualTime <span style=color:#f92672>=</span> millis() <span style=color:#f92672>-</span> myTime) <span style=color:#f92672>&lt;</span> Period){
</span></span><span style=display:flex><span>     <span style=color:#75715e>// Auslesen aller Pins für die Zeit Period
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin1) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin1 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin1&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin2) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin2 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin2&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      } 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin3) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin3 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin3&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      } 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin4) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin4 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin4&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      } 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin5) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin5 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin5&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      }     
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin6) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin6 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin6&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      } 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin7) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin7 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin7&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      } 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span>(digitalRead(SensorPin8) <span style=color:#f92672>==</span> LOW){    
</span></span><span style=display:flex><span>        Pin8 <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>        Serial.println(<span style=color:#e6db74>&#34;Pin8&#34;</span>);
</span></span><span style=display:flex><span>        delay(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }  
</span></span><span style=display:flex><span>    Motor.step(<span style=color:#ae81ff>1500</span>);
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>Jetzt muss nur noch geprüft werden welche Sensoren an waren und welche nicht. Dann kann das Vermögen und das Display geupdatet werden.</p><p>Dreht beim Testen gerne an der Schraube und probiert etwas herum. Wenn eine Münze vorbei rollt, sollte die zweite LED aufblitzen (mehrmaliges aufblitzen ist auch in Ordnung).</p><p>Sollte bei euch die SD Karte laufen, könnt ihr in den jeweiligen if-Abfragen die Datei auf der SD Karte aktualisieren.</p><p>Es ist möglich, dass euer OLED-Display das € Zeichen nicht darstellen kann.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>/////////////////////////////////////////////////////////////
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>/*  Erkennung durch welchen Münzslot die Münze fällt.
</span></span></span><span style=display:flex><span><span style=color:#75715e>      Da beim vorbei rollen alle Sensoren die Münze erkennen, 
</span></span></span><span style=display:flex><span><span style=color:#75715e>      muss der letzte positive Sensor gefunden werden. 
</span></span></span><span style=display:flex><span><span style=color:#75715e>      Wenn ein Sensor eine Münze erkannt hat und der 
</span></span></span><span style=display:flex><span><span style=color:#75715e>      dahinterliegende Sensore keine Münze erkannt hat,
</span></span></span><span style=display:flex><span><span style=color:#75715e>      muss die Münze durch den vorhereigen Slot gefallen sein.
</span></span></span><span style=display:flex><span><span style=color:#75715e>  */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Pin1 <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Pin2){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.01</span>;
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;0.01&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Pin2 <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Pin3){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.02</span>;
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;0.02&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Pin3 <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Pin4){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.1</span>;
</span></span><span style=display:flex><span>   Serial.println(<span style=color:#e6db74>&#34;10&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Pin4 <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Pin5){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;5&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Pin5 <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Pin6){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.2</span>;
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;20&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Pin6 <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Pin7){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;100&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(Pin7 <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span>Pin8){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.5</span>;
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;50&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(Pin8){
</span></span><span style=display:flex><span>    MoneyInBank <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    Serial.println(<span style=color:#e6db74>&#34;200&#34;</span>);
</span></span><span style=display:flex><span>    delay(<span style=color:#ae81ff>500</span>);
</span></span><span style=display:flex><span>    oled.clear(); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; Aktueller Kontostand&#34;</span>); 
</span></span><span style=display:flex><span>    oled.println(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34; &#34;</span>);
</span></span><span style=display:flex><span>    oled.print(MoneyInBank); 
</span></span><span style=display:flex><span>    oled.print(<span style=color:#e6db74>&#34;€&#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Setze bools zurück, um die nächste Münze richtig zu erkennen
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  Pin1 <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  Pin2 <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  Pin3 <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  Pin4 <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  Pin5 <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  Pin6 <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  Pin7 <span style=color:#f92672>=</span> false;
</span></span><span style=display:flex><span>  Pin8 <span style=color:#f92672>=</span> false;
</span></span></code></pre></div><p>Sobald alle Sensoren richtig funktionieren, kann es mit dem Löten los gehen!</p><h1 id=schritt-6-löten>Schritt 6 Löten:</h1><p><img src=8.png alt=Bild8></p><p>Lötet alle Pins nach diesem Plan an. Für die Münzerkennung muss einer der Drahte mit GRND verbunden sein und der anderer mit Pin 5.</p><p>Alle - Pole (GRND) können in einer Reihe auf einer Platine festgelötet werden.
Alle + Pole (5V) können in einer Reihe auf einer Platine festgelötet werden.</p><p><img src=9.jpeg alt=Bild09></p><p><img src=10.jpeg alt=Bild10></p><p>Einen Schönheitspreis gewinnt es nicht, aber es funktioniert. Sollten manche Sensoren nicht funktionieren könnt ihr versuchen eine Weitere Stromquelle anzuschließen. Ich habe ein normales Micro-USB Kabel aufgeschnitten und an ein Schalter gelötet.
Dann hab ich ein 5V-9V Netzteil von meinen Handy genommen und es daran angeschlossen.
Dadurch hat sich das Problem bei mir behoben.</p><h1 id=schritt-7-zusammenbauen>Schritt 7 Zusammenbauen:</h1><ol><li>Einsetzten der Platte mit den Sensoren. (Am besten in einem leichten Winkel. Sensoren sollen leicht nach oben zeigen. und sich auf Höhe der Löcher in der Schiene befinden.</li><li>Boden anleimen.</li><li>Platinen anschrauben oder ankleben.</li><li>Kabel abisolieren aufräumen.</li><li>Deckel anleimen.</li><li>Tür mit zwei Scharnieren anschrauben (linke Seite), sodass die Schiene sauber abschließt mit der vorherigen Rampe.</li></ol><h1 id=schritt-8-sparen>Schritt 8 Sparen:</h1><p>Nun kommt der leichteste und vielleicht auch der Schwierigste Teil. Schmeißt eure Münzen auf die Platte und staut darüber was ihr gebaut habt!</p></div></section><footer><p>&copy; 1947 - 2023</p></footer></main></body></html>